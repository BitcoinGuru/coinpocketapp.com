"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),sjcl.bitArray={bitSlice:function(t,e,s){return t=sjcl.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===s?t:sjcl.bitArray.clamp(t,s-e)},extract:function(t,e,s){var i,r=Math.floor(-e-s&31);return i=-32&(e+s-1^e)?t[e/32|0]<<32-r^t[e/32+1|0]>>>r:t[e/32|0]>>>r,i&(1<<s)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var s=t[t.length-1],i=sjcl.bitArray.getPartial(s);return 32===i?t.concat(e):sjcl.bitArray._shiftRight(e,i,0|s,t.slice(0,t.length-1))},bitLength:function(t){var e,s=t.length;return 0===s?0:(e=t[s-1],32*(s-1)+sjcl.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var s=t.length;return e=31&e,s>0&&e&&(t[s-1]=sjcl.bitArray.partial(e,t[s-1]&2147483648>>e-1,1)),t},partial:function(t,e,s){return 32===t?e:(s?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(sjcl.bitArray.bitLength(t)!==sjcl.bitArray.bitLength(e))return!1;var s,i=0;for(s=0;s<t.length;s++)i|=t[s]^e[s];return 0===i},_shiftRight:function(t,e,s,i){var r,n,c=0;for(void 0===i&&(i=[]);e>=32;e-=32)i.push(s),s=0;if(0===e)return i.concat(t);for(r=0;r<t.length;r++)i.push(s|t[r]>>>e),s=t[r]<<32-e;return c=t.length?t[t.length-1]:0,n=sjcl.bitArray.getPartial(c),i.push(sjcl.bitArray.partial(e+n&31,e+n>32?s:i.pop(),1)),i},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},sjcl.codec.utf8String={fromBits:function(t){var e,s,i="",r=sjcl.bitArray.bitLength(t);for(e=0;r/8>e;e++)0===(3&e)&&(s=t[e/4]),i+=String.fromCharCode(s>>>24),s<<=8;return decodeURIComponent(escape(i))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,s=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t.charCodeAt(e),3===(3&e)&&(s.push(i),i=0);return 3&e&&s.push(sjcl.bitArray.partial(8*(3&e),i)),s}},sjcl.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,s,i,r,n,c=this._tables[0][4],o=this._tables[1],a=t.length,l=1;if(4!==a&&6!==a&&8!==a)throw new sjcl.exception.invalid("invalid aes key size");for(this._key=[r=t.slice(0),n=[]],e=a;4*a+28>e;e++)i=r[e-1],(e%a===0||8===a&&e%a===4)&&(i=c[i>>>24]<<24^c[i>>16&255]<<16^c[i>>8&255]<<8^c[255&i],e%a===0&&(i=i<<8^i>>>24^l<<24,l=l<<1^283*(l>>7))),r[e]=r[e-a]^i;for(s=0;e;s++,e--)i=r[3&s?e:e-4],n[s]=4>=e||4>s?i:o[0][c[i>>>24]]^o[1][c[i>>16&255]]^o[2][c[i>>8&255]]^o[3][c[255&i]]},sjcl.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,s,i,r,n,c,o,a,l=this._tables[0],h=this._tables[1],f=l[4],u=h[4],d=[],p=[];for(t=0;256>t;t++)p[(d[t]=t<<1^283*(t>>7))^t]=t;for(e=s=0;!f[e];e^=i||1,s=p[s]||1)for(c=s^s<<1^s<<2^s<<3^s<<4,c=c>>8^255&c^99,f[e]=c,u[c]=e,n=d[r=d[i=d[e]]],a=16843009*n^65537*r^257*i^16843008*e,o=257*d[c]^16843008*c,t=0;4>t;t++)l[t][e]=o=o<<24^o>>>8,h[t][c]=a=a<<24^a>>>8;for(t=0;5>t;t++)l[t]=l[t].slice(0),h[t]=h[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new sjcl.exception.invalid("invalid aes block size");var s,i,r,n,c=this._key[e],o=t[0]^c[0],a=t[e?3:1]^c[1],l=t[2]^c[2],h=t[e?1:3]^c[3],f=c.length/4-2,u=4,d=[0,0,0,0],p=this._tables[e],b=p[0],m=p[1],g=p[2],y=p[3],_=p[4];for(n=0;f>n;n++)s=b[o>>>24]^m[a>>16&255]^g[l>>8&255]^y[255&h]^c[u],i=b[a>>>24]^m[l>>16&255]^g[h>>8&255]^y[255&o]^c[u+1],r=b[l>>>24]^m[h>>16&255]^g[o>>8&255]^y[255&a]^c[u+2],h=b[h>>>24]^m[o>>16&255]^g[a>>8&255]^y[255&l]^c[u+3],u+=4,o=s,a=i,l=r;for(n=0;4>n;n++)d[e?3&-n:n]=_[o>>>24]<<24^_[a>>16&255]<<16^_[l>>8&255]<<8^_[255&h]^c[u++],s=o,o=a,a=l,l=h,h=s;return d}},sjcl.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.sha256.hash=function(t){return(new sjcl.hash.sha256).update(t).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,s=this._buffer=sjcl.bitArray.concat(this._buffer,t),i=this._length,r=this._length=i+sjcl.bitArray.bitLength(t);for(e=512+i&-512;r>=e;e+=512)this._block(s.splice(0,16));return this},finalize:function(){var t,e=this._buffer,s=this._h;for(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),s},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,s=0,i=2;t:for(;64>s;i++){for(e=2;i>=e*e;e++)if(i%e===0)continue t;8>s&&(this._init[s]=t(Math.pow(i,.5))),this._key[s]=t(Math.pow(i,1/3)),s++}},_block:function(t){var e,s,i,r,n=t.slice(0),c=this._h,o=this._key,a=c[0],l=c[1],h=c[2],f=c[3],u=c[4],d=c[5],p=c[6],b=c[7];for(e=0;64>e;e++)16>e?s=n[e]:(i=n[e+1&15],r=n[e+14&15],s=n[15&e]=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+n[15&e]+n[e+9&15]|0),s=s+b+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(p^u&(d^p))+o[e],b=p,p=d,d=u,u=f+s|0,f=h,h=l,l=a,a=s+(l&h^f&(l^h))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;c[0]=c[0]+a|0,c[1]=c[1]+l|0,c[2]=c[2]+h|0,c[3]=c[3]+f|0,c[4]=c[4]+u|0,c[5]=c[5]+d|0,c[6]=c[6]+p|0,c[7]=c[7]+b|0}},sjcl.prng=function(t){this._pools=[new sjcl.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},sjcl.prng.prototype={randomWords:function(t,e){var s,i,r=[],n=this.isReady(e);if(n===this._NOT_READY)throw new sjcl.exception.notReady("generator isn't seeded");for(n&this._REQUIRES_RESEED&&this._reseedFromPools(!(n&this._READY)),s=0;t>s;s+=4)(s+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),i=this._gen4words(),r.push(i[0],i[1],i[2],i[3]);return this._gate(),r.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=t},addEntropy:function(t,e,s){s=s||"user";var i,r,n,c,o=(new Date).valueOf(),a=this._robins[s],l=this.isReady(),h=0;switch(i=this._collectorIds[s],void 0===i&&(i=this._collectorIds[s]=this._collectorIdNext++),void 0===a&&(a=this._robins[s]=0),this._robins[s]=(this._robins[s]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[a].update([i,this._eventId++,1,e,o,1,0|t]);break;case"object":if(c=Object.prototype.toString.call(t),"[object Uint32Array]"===c){for(n=[],r=0;r<t.length;r++)n.push(t[r]);t=n}else for("[object Array]"!==c&&(h=1),r=0;r<t.length&&!h;r++)"number"!=typeof t[r]&&(h=1);if(!h){if(void 0===e)for(e=0,r=0;r<t.length;r++)for(n=t[r];n>0;)e++,n>>>=1;this._pools[a].update([i,this._eventId++,2,e,o,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[a].update([i,this._eventId++,3,e,o,t.length]),this._pools[a].update(t);break;default:h=1}if(h)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[a]+=e,this._poolStrength+=e,l===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1);else{if(!document.attachEvent)throw new sjcl.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var s,i,r=this._callbacks[t],n=[];for(i in r)r.hasOwnProperty(i)&&r[i]===e&&n.push(i);for(s=0;s<n.length;s++)i=n[s],delete r[i]},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;4>t&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new sjcl.cipher.aes(this._key)},_reseed:function(t){this._key=sjcl.hash.sha256.hash(this._key.concat(t)),this._cipher=new sjcl.cipher.aes(this._key);for(var e=0;4>e&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,s=[],i=0;for(this._nextReseed=s[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;16>e;e++)s.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(s=s.concat(this._pools[e].finalize()),i+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new sjcl.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=i,i>this._strength&&(this._strength=i),this._reseedCount++,this._reseed(s)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX||0,s=t.y||t.clientY||t.offsetY||0;sjcl.random.addEntropy([e,s],2,"mouse"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(t){window&&window.performance&&"function"==typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),t,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),t,"loadtime")},_accelerometerCollector:function(t){var e=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z;if(window.orientation){var s=window.orientation;"number"==typeof s&&sjcl.random.addEntropy(s,1,"accelerometer")}e&&sjcl.random.addEntropy(e,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(t,e){var s,i=sjcl.random._callbacks[t],r=[];for(s in i)i.hasOwnProperty(s)&&r.push(i[s]);for(s=0;s<r.length;s++)r[s](e)}},sjcl.random=new sjcl.prng(6),function(){function t(){try{return require("crypto")}catch(t){return null}}try{var e,s,i;if("undefined"!=typeof module&&module.exports&&(s=t())&&s.randomBytes)e=s.randomBytes(128),e=new Uint32Array(new Uint8Array(e).buffer),sjcl.random.addEntropy(e,1024,"crypto.randomBytes");else if(window&&Uint32Array){if(i=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(i);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(i)}sjcl.random.addEntropy(i,1024,"crypto.getRandomValues")}}catch(r){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(r))}}(),sjcl.bn=function(t){this.initWith(t)},sjcl.bn.prototype={radix:24,maxMul:8,_class:sjcl.bn,copy:function(){return new this._class(this)},initWith:function(t){var e,s=0;switch(typeof t){case"object":this.limbs=t.limbs.slice(0);break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,s=0;s<t.length;s+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-s-e,0),t.length-s),16));break;default:this.limbs=[0]}return this},equals:function(t){"number"==typeof t&&(t=new this._class(t));var e,s=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)s|=this.getLimb(e)^t.getLimb(e);return 0===s},getLimb:function(t){return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"==typeof t&&(t=new this._class(t));var e,s,i,r=0,n=0;for(e=Math.max(this.limbs.length,t.limbs.length)-1;e>=0;e--)s=this.getLimb(e),i=t.getLimb(e),n|=i-s&~r,r|=s-i&~n;return(n|~r)>>>31},toString:function(){this.fullReduce();var t,e,s="",i=this.limbs;for(t=0;t<this.limbs.length;t++){for(e=i[t].toString(16);t<this.limbs.length-1&&e.length<6;)e="0"+e;s=e+s}return"0x"+s},addM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,s=this.limbs,i=t.limbs;for(e=s.length;e<i.length;e++)s[e]=0;for(e=0;e<i.length;e++)s[e]+=i[e];return this},doubleM:function(){var t,e,s=0,i=this.radix,r=this.radixMask,n=this.limbs;for(t=0;t<n.length;t++)e=n[t],e=e+e+s,n[t]=e&r,s=e>>i;return s&&n.push(s),this},halveM:function(){var t,e,s=0,i=this.radix,r=this.limbs;for(t=r.length-1;t>=0;t--)e=r[t],r[t]=e+s>>1,s=(1&e)<<i;return r[r.length-1]||r.pop(),this},subM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,s=this.limbs,i=t.limbs;for(e=s.length;e<i.length;e++)s[e]=0;for(e=0;e<i.length;e++)s[e]-=i[e];return this},mod:function(t){var e=!this.greaterEquals(new sjcl.bn(0));t=new sjcl.bn(t).normalize();var s=new sjcl.bn(this).normalize(),i=0;for(e&&(s=new sjcl.bn(0).subM(s).normalize());s.greaterEquals(t);i++)t.doubleM();for(e&&(s=t.sub(s).normalize());i>0;i--)t.halveM(),s.greaterEquals(t)&&s.subM(t).normalize();return s.trim()},inverseMod:function(t){var e,s,i=new sjcl.bn(1),r=new sjcl.bn(0),n=new sjcl.bn(this),c=new sjcl.bn(t),o=1;if(!(1&t.limbs[0]))throw new sjcl.exception.invalid("inverseMod: p must be odd");do for(1&n.limbs[0]&&(n.greaterEquals(c)||(e=n,n=c,c=e,e=i,i=r,r=e),n.subM(c),n.normalize(),i.greaterEquals(r)||i.addM(t),i.subM(r)),n.halveM(),1&i.limbs[0]&&i.addM(t),i.normalize(),i.halveM(),s=o=0;s<n.limbs.length;s++)o|=n.limbs[s];while(o);if(!c.equals(1))throw new sjcl.exception.invalid("inverseMod: p and x must be relatively prime");return r},add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"==typeof t&&(t=new this._class(t));var e,s,i,r=this.limbs,n=t.limbs,c=r.length,o=n.length,a=new this._class,l=a.limbs,h=this.maxMul;for(e=0;e<this.limbs.length+t.limbs.length+1;e++)l[e]=0;for(e=0;c>e;e++){for(i=r[e],s=0;o>s;s++)l[e+s]+=i*n[s];--h||(h=this.maxMul,a.cnormalize())}return a.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var e,s,i=new this._class(1),r=this;for(e=0;e<t.length;e++)for(s=0;s<this.radix;s++)t[e]&1<<s&&(i=i.mul(r)),r=r.square();return i},mulmod:function(t,e){return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){for(var s=new sjcl.bn(1),i=new sjcl.bn(this),r=new sjcl.bn(t);;){if(1&r.limbs[0]&&(s=s.mulmod(i,e)),r.halveM(),r.equals(0))break;i=i.mulmod(i,e)}return s.normalize().reduce()},trim:function(){var t,e=this.limbs;do t=e.pop();while(e.length&&0===t);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var t,e,s,i=0,r=(this.placeVal,this.ipv),n=this.limbs,c=n.length,o=this.radixMask;for(t=0;c>t||0!==i&&-1!==i;t++)e=(n[t]||0)+i,s=n[t]=e&o,i=(e-s)*r;return-1===i&&(n[t-1]-=this.placeVal),this},cnormalize:function(){var t,e,s,i=0,r=this.ipv,n=this.limbs,c=n.length,o=this.radixMask;for(t=0;c-1>t;t++)e=n[t]+i,s=n[t]=e&o,i=(e-s)*r;return n[t]+=i,this},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var e=Math.floor((t-1)/24),s=sjcl.bitArray,i=(t+7&-8)%this.radix||this.radix,r=[s.partial(i,this.getLimb(e))];for(e--;e>=0;e--)r=s.concat(r,[s.partial(Math.min(this.radix,t),this.getLimb(e))]),t-=this.radix;return r},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>>=1)t++;return t+7&-8}},sjcl.bn.fromBits=function(t){var e=this,s=new e,i=[],r=sjcl.bitArray,n=this.prototype,c=Math.min(this.bitLength||4294967296,r.bitLength(t)),o=c%n.radix||n.radix;for(i[0]=r.extract(t,0,o);c>o;o+=n.radix)i.unshift(r.extract(t,o,n.radix));return s.limbs=i,s},sjcl.bn.prototype.ipv=1/(sjcl.bn.prototype.placeVal=Math.pow(2,sjcl.bn.prototype.radix)),sjcl.bn.prototype.radixMask=(1<<sjcl.bn.prototype.radix)-1,sjcl.bn.pseudoMersennePrime=function(t,e){function s(t){this.initWith(t)}var i,r,n,c=s.prototype=new sjcl.bn;for(n=c.modOffset=Math.ceil(r=t/c.radix),c.exponent=t,c.offset=[],c.factor=[],c.minOffset=n,c.fullMask=0,c.fullOffset=[],c.fullFactor=[],c.modulus=s.modulus=new sjcl.bn(Math.pow(2,t)),c.fullMask=0|-Math.pow(2,t%c.radix),i=0;i<e.length;i++)c.offset[i]=Math.floor(e[i][0]/c.radix-r),c.fullOffset[i]=Math.ceil(e[i][0]/c.radix-r),c.factor[i]=e[i][1]*Math.pow(.5,t-e[i][0]+c.offset[i]*c.radix),c.fullFactor[i]=e[i][1]*Math.pow(.5,t-e[i][0]+c.fullOffset[i]*c.radix),c.modulus.addM(new sjcl.bn(Math.pow(2,e[i][0])*e[i][1])),c.minOffset=Math.min(c.minOffset,-c.offset[i]);return c._class=s,c.modulus.cnormalize(),c.reduce=function(){var t,e,s,i,r=this.modOffset,n=this.limbs,c=this.offset,o=this.offset.length,a=this.factor;for(t=this.minOffset;n.length>r;){for(s=n.pop(),i=n.length,e=0;o>e;e++)n[i+c[e]]-=a[e]*s;t--,t||(n.push(0),this.cnormalize(),t=this.minOffset)}return this.cnormalize(),this},c._strongReduce=-1===c.fullMask?c.reduce:function(){var t,e,s=this.limbs,i=s.length-1;if(this.reduce(),i===this.modOffset-1){for(e=s[i]&this.fullMask,s[i]-=e,t=0;t<this.fullOffset.length;t++)s[i+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},c.fullReduce=function(){var t,e;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},c.inverse=function(){return this.power(this.modulus.sub(2))},s.fromBits=sjcl.bn.fromBits,s};var sbp=sjcl.bn.pseudoMersennePrime;sjcl.bn.prime={p127:sbp(127,[[0,-1]]),p25519:sbp(255,[[0,-19]]),p192k:sbp(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),p224k:sbp(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:sbp(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:sbp(192,[[0,-1],[64,-1]]),p224:sbp(224,[[0,1],[96,-1]]),p256:sbp(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:sbp(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:sbp(521,[[0,-1]])},sjcl.bn.random=function(t,e){"object"!=typeof t&&(t=new sjcl.bn(t));for(var s,i,r=t.limbs.length,n=t.limbs[r-1]+1,c=new sjcl.bn;;){do s=sjcl.random.randomWords(r,e),s[r-1]<0&&(s[r-1]+=4294967296);while(Math.floor(s[r-1]/n)===Math.floor(4294967296/n));for(s[r-1]%=n,i=0;r-1>i;i++)s[i]&=t.radixMask;if(c.limbs=s,!c.greaterEquals(t))return c}},sjcl.ecc={},sjcl.ecc.point=function(t,e,s){void 0===e?this.isIdentity=!0:(this.x=e,this.y=s,this.isIdentity=!1),this.curve=t},sjcl.ecc.point.prototype={toJac:function(){return new sjcl.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,s){return this.toJac().mult2(t,this,e,s).toAffine()},multiples:function(){var t,e,s;if(void 0===this._multiples)for(s=this.toJac().doubl(),t=this._multiples=[new sjcl.ecc.point(this.curve),this,s.toAffine()],e=3;16>e;e++)s=s.add(this),t.push(s.toAffine());return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return sjcl.bitArray.concat(this.x.toBits(),this.y.toBits())}},sjcl.ecc.pointJac=function(t,e,s,i){void 0===e?this.isIdentity=!0:(this.x=e,this.y=s,this.z=i,this.isIdentity=!1),this.curve=t},sjcl.ecc.pointJac.prototype={add:function(t){var e,s,i,r,n,c,o,a,l,h,f,u=this;if(u.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return u.isIdentity?t.toJac():t.isIdentity?u:(e=u.z.square(),s=t.x.mul(e).subM(u.x),s.equals(0)?u.y.equals(t.y.mul(e.mul(u.z)))?u.doubl():new sjcl.ecc.pointJac(u.curve):(i=t.y.mul(e.mul(u.z)).subM(u.y),r=s.square(),n=i.square(),c=s.square().mul(s).addM(u.x.add(u.x).mul(r)),o=n.subM(c),a=u.x.mul(r).subM(o).mul(i),l=u.y.mul(s.square().mul(s)),h=a.subM(l),f=u.z.mul(s),new sjcl.ecc.pointJac(this.curve,o,h,f)))},doubl:function(){if(this.isIdentity)return this;var t=this.y.square(),e=t.mul(this.x.mul(4)),s=t.square().mul(8),i=this.z.square(),r=this.curve.a.toString()==new sjcl.bn(-3).toString()?this.x.sub(i).mul(3).mul(this.x.add(i)):this.x.square().mul(3).add(i.square().mul(this.curve.a)),n=r.square().subM(e).subM(e),c=e.sub(n).mul(r).subM(s),o=this.y.add(this.y).mul(this.z);return new sjcl.ecc.pointJac(this.curve,n,c,o)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new sjcl.ecc.point(this.curve);var t=this.z.inverse(),e=t.square();return new sjcl.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var s,i,r=new sjcl.ecc.point(this.curve).toJac(),n=e.multiples();for(s=t.length-1;s>=0;s--)for(i=sjcl.bn.prototype.radix-4;i>=0;i-=4)r=r.doubl().doubl().doubl().doubl().add(n[t[s]>>i&15]);return r},mult2:function(t,e,s,i){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs),"number"==typeof s?s=[s]:void 0!==s.limbs&&(s=s.normalize().limbs);var r,n,c,o,a=new sjcl.ecc.point(this.curve).toJac(),l=e.multiples(),h=i.multiples();for(r=Math.max(t.length,s.length)-1;r>=0;r--)for(c=0|t[r],o=0|s[r],n=sjcl.bn.prototype.radix-4;n>=0;n-=4)a=a.doubl().doubl().doubl().doubl().add(l[c>>n&15]).add(h[o>>n&15]);return a},isValid:function(){var t=this.z.square(),e=t.square(),s=e.mul(t);return this.y.square().equals(this.curve.b.mul(s).add(this.x.mul(this.curve.a.mul(e).add(this.x.square()))))}},sjcl.ecc.curve=function(t,e,s,i,r,n){this.field=t,this.r=new sjcl.bn(e),this.a=new t(s),this.b=new t(i),this.G=new sjcl.ecc.point(this,new t(r),new t(n))},sjcl.ecc.curve.prototype.fromBits=function(t){var e=sjcl.bitArray,s=this.field.prototype.exponent+7&-8,i=new sjcl.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,s)),this.field.fromBits(e.bitSlice(t,s,2*s)));if(!i.isValid())throw new sjcl.exception.corrupt("not on the curve!");return i},sjcl.ecc.curves={c192:new sjcl.ecc.curve(sjcl.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new sjcl.ecc.curve(sjcl.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new sjcl.ecc.curve(sjcl.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new sjcl.ecc.curve(sjcl.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),k192:new sjcl.ecc.curve(sjcl.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),k224:new sjcl.ecc.curve(sjcl.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),k256:new sjcl.ecc.curve(sjcl.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},sjcl.ecc.basicKey={publicKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._point=e instanceof Array?t.fromBits(e):e,this.get=function(){var t=this._point.toBits(),e=sjcl.bitArray.bitLength(t),s=sjcl.bitArray.bitSlice(t,0,e/2),i=sjcl.bitArray.bitSlice(t,e/2);return{x:s,y:i}}},secretKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._exponent=e,this.get=function(){return this._exponent.toBits()}}},sjcl.ecc.basicKey.generateKeys=function(t){return function(e,s,i){if(e=e||256,"number"==typeof e&&(e=sjcl.ecc.curves["c"+e],void 0===e))throw new sjcl.exception.invalid("no such curve");i=i||sjcl.bn.random(e.r,s);var r=e.G.mult(i);return{pub:new sjcl.ecc[t].publicKey(e,r),sec:new sjcl.ecc[t].secretKey(e,i)}}},sjcl.ecc.elGamal={generateKeys:sjcl.ecc.basicKey.generateKeys("elGamal"),publicKey:function(){sjcl.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function(){sjcl.ecc.basicKey.secretKey.apply(this,arguments)}},sjcl.ecc.elGamal.publicKey.prototype={kem:function(t){var e=sjcl.bn.random(this._curve.r,t),s=this._curve.G.mult(e).toBits(),i=sjcl.hash.sha256.hash(this._point.mult(e).toBits());return{key:i,tag:s}}},sjcl.ecc.elGamal.secretKey.prototype={unkem:function(t){return sjcl.hash.sha256.hash(this._curve.fromBits(t).mult(this._exponent).toBits())},dh:function(t){return sjcl.hash.sha256.hash(t._point.mult(this._exponent).toBits())}},sjcl.ecc.ecdsa={generateKeys:sjcl.ecc.basicKey.generateKeys("ecdsa")},sjcl.ecc.ecdsa.publicKey=function(){sjcl.ecc.basicKey.publicKey.apply(this,arguments)},sjcl.ecc.ecdsa.publicKey.prototype={verify:function(t,e,s){sjcl.bitArray.bitLength(t)>this._curveBitLength&&(t=sjcl.bitArray.clamp(t,this._curveBitLength));var i=sjcl.bitArray,r=this._curve.r,n=this._curveBitLength,c=sjcl.bn.fromBits(i.bitSlice(e,0,n)),o=sjcl.bn.fromBits(i.bitSlice(e,n,2*n)),a=s?o:o.inverseMod(r),l=sjcl.bn.fromBits(t).mul(a).mod(r),h=c.mul(a).mod(r),f=this._curve.G.mult2(l,h,this._point).x;if(c.equals(0)||o.equals(0)||c.greaterEquals(r)||o.greaterEquals(r)||!f.equals(c)){if(void 0===s)return this.verify(t,e,!0);throw new sjcl.exception.corrupt("signature didn't check out")}return!0}},sjcl.ecc.ecdsa.secretKey=function(){sjcl.ecc.basicKey.secretKey.apply(this,arguments)},sjcl.ecc.ecdsa.secretKey.prototype={sign:function(t,e,s,i){sjcl.bitArray.bitLength(t)>this._curveBitLength&&(t=sjcl.bitArray.clamp(t,this._curveBitLength));var r=this._curve.r,n=r.bitLength(),c=i||sjcl.bn.random(r.sub(1),e).add(1),o=this._curve.G.mult(c).x.mod(r),a=sjcl.bn.fromBits(t).add(o.mul(this._exponent)),l=s?a.inverseMod(r).mul(c).mod(r):a.mul(c.inverseMod(r)).mod(r);return sjcl.bitArray.concat(o.toBits(n),l.toBits(n))}},sjcl.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,s){var i,r="",n=0,c=sjcl.codec.base64._chars,o=0,a=sjcl.bitArray.bitLength(t);for(s&&(c=c.substr(0,62)+"-_"),i=0;6*r.length<a;)r+=c.charAt((o^t[i]>>>n)>>>26),6>n?(o=t[i]<<6-n,n+=26,i++):(o<<=6,n-=6);for(;3&r.length&&!e;)r+="=";return r},toBits:function(t,e){t=t.replace(/\s|=/g,"");var s,i,r=[],n=0,c=sjcl.codec.base64._chars,o=0;for(e&&(c=c.substr(0,62)+"-_"),s=0;s<t.length;s++){if(i=c.indexOf(t.charAt(s)),0>i)throw new sjcl.exception.invalid("this isn't base64!");n>26?(n-=26,r.push(o^i>>>n),o=i<<32-n):(n+=6,o^=i<<32-n)}return 56&n&&r.push(sjcl.bitArray.partial(56&n,o,1)),r}},sjcl.codec.base64url={fromBits:function(t){return sjcl.codec.base64.fromBits(t,1,1)},toBits:function(t){return sjcl.codec.base64.toBits(t,1)}},sjcl.codec.hex={fromBits:function(t){var e,s="";for(e=0;e<t.length;e++)s+=((0|t[e])+0xf00000000000).toString(16).substr(4);return s.substr(0,sjcl.bitArray.bitLength(t)/4)},toBits:function(t){var e,s,i=[];for(t=t.replace(/\s|0x/g,""),s=t.length,t+="00000000",e=0;e<t.length;e+=8)i.push(0^parseInt(t.substr(e,8),16));return sjcl.bitArray.clamp(i,4*s)}},sjcl.codec.bytes={fromBits:function(t){var e,s,i=[],r=sjcl.bitArray.bitLength(t);for(e=0;r/8>e;e++)0===(3&e)&&(s=t[e/4]),i.push(s>>>24),s<<=8;return i},toBits:function(t){var e,s=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t[e],3===(3&e)&&(s.push(i),i=0);return 3&e&&s.push(sjcl.bitArray.partial(8*(3&e),i)),s}},sjcl.misc.hmac=function(t,e){this._hash=e=e||sjcl.hash.sha256;var s,i=[[],[]],r=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>r&&(t=e.hash(t)),s=0;r>s;s++)i[0][s]=909522486^t[s],i[1][s]=1549556828^t[s];this._baseHash[0].update(i[0]),this._baseHash[1].update(i[1]),this._resultHash=new e(this._baseHash[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(t){if(this._updated)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},sjcl.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},sjcl.misc.hmac.prototype.update=function(t){this._updated=!0,this._resultHash.update(t)},sjcl.misc.hmac.prototype.digest=function(){var t=this._resultHash.finalize(),e=new this._hash(this._baseHash[1]).update(t).finalize();return this.reset(),e},sjcl.misc.pbkdf2=function(t,e,s,i,r){if(s=s||1e3,0>i||0>s)throw sjcl.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),r=r||sjcl.misc.hmac;var n,c,o,a,l,h=new r(t),f=[],u=sjcl.bitArray;for(l=1;32*f.length<(i||1);l++){for(n=c=h.encrypt(u.concat(e,[l])),o=1;s>o;o++)for(c=h.encrypt(c),a=0;a<c.length;a++)n[a]^=c[a];f=f.concat(n)}return i&&(f=u.clamp(f,i)),f},sjcl.mode.ccm={name:"ccm",encrypt:function(t,e,s,i,r){var n,c,o=e.slice(0),a=sjcl.bitArray,l=a.bitLength(s)/8,h=a.bitLength(o)/8;if(r=r||64,i=i||[],7>l)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(n=2;4>n&&h>>>8*n;n++);return 15-l>n&&(n=15-l),s=a.clamp(s,8*(15-n)),c=sjcl.mode.ccm._computeTag(t,e,s,i,r,n),o=sjcl.mode.ccm._ctrMode(t,o,s,c,r,n),a.concat(o.data,o.tag)},decrypt:function(t,e,s,i,r){r=r||64,i=i||[];var n,c,o=sjcl.bitArray,a=o.bitLength(s)/8,l=o.bitLength(e),h=o.clamp(e,l-r),f=o.bitSlice(e,l-r);if(l=(l-r)/8,7>a)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(n=2;4>n&&l>>>8*n;n++);if(15-a>n&&(n=15-a),s=o.clamp(s,8*(15-n)),h=sjcl.mode.ccm._ctrMode(t,h,s,f,r,n),c=sjcl.mode.ccm._computeTag(t,h.data,s,i,r,n),!o.equal(h.tag,c))throw new sjcl.exception.corrupt("ccm: tag doesn't match");
return h.data},_computeTag:function(t,e,s,i,r,n){var c,o,a,l=[],h=sjcl.bitArray,f=h._xor4;if(r/=8,r%2||4>r||r>16)throw new sjcl.exception.invalid("ccm: invalid tag length");if(i.length>4294967295||e.length>4294967295)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");if(c=[h.partial(8,(i.length?64:0)|r-2<<2|n-1)],c=h.concat(c,s),c[3]|=h.bitLength(e)/8,c=t.encrypt(c),i.length)for(o=h.bitLength(i)/8,65279>=o?l=[h.partial(16,o)]:4294967295>=o&&(l=h.concat([h.partial(16,65534)],[o])),l=h.concat(l,i),a=0;a<l.length;a+=4)c=t.encrypt(f(c,l.slice(a,a+4).concat([0,0,0])));for(a=0;a<e.length;a+=4)c=t.encrypt(f(c,e.slice(a,a+4).concat([0,0,0])));return h.clamp(c,8*r)},_ctrMode:function(t,e,s,i,r,n){var c,o,a,l=sjcl.bitArray,h=l._xor4,f=e.length,u=l.bitLength(e);if(a=l.concat([l.partial(8,n-1)],s).concat([0,0,0]).slice(0,4),i=l.bitSlice(h(i,t.encrypt(a)),0,r),!f)return{tag:i,data:[]};for(o=0;f>o;o+=4)a[3]++,c=t.encrypt(a),e[o]^=c[0],e[o+1]^=c[1],e[o+2]^=c[2],e[o+3]^=c[3];return{tag:i,data:l.clamp(e,u)}}},sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(t,e,s,i){s=s||{},i=i||{};var r,n,c,o=sjcl.json,a=o._add({iv:sjcl.random.randomWords(4,0)},o.defaults);if(o._add(a,s),c=a.adata,"string"==typeof a.salt&&(a.salt=sjcl.codec.base64.toBits(a.salt)),"string"==typeof a.iv&&(a.iv=sjcl.codec.base64.toBits(a.iv)),!sjcl.mode[a.mode]||!sjcl.cipher[a.cipher]||"string"==typeof t&&a.iter<=100||64!==a.ts&&96!==a.ts&&128!==a.ts||128!==a.ks&&192!==a.ks&&256!==a.ks||a.iv.length<2||a.iv.length>4)throw new sjcl.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?(r=sjcl.misc.cachedPbkdf2(t,a),t=r.key.slice(0,a.ks/32),a.salt=r.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.publicKey&&(r=t.kem(),a.kemtag=r.tag,t=r.key.slice(0,a.ks/32)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof c&&(c=sjcl.codec.utf8String.toBits(c)),n=new sjcl.cipher[a.cipher](t),o._add(i,a),i.key=t,a.ct=sjcl.mode[a.mode].encrypt(n,e,a.iv,c,a.ts),a},encrypt:function(){var t=sjcl.json,e=t._encrypt.apply(t,arguments);return t.encode(e)},_decrypt:function(t,e,s,i){s=s||{},i=i||{};var r,n,c,o=sjcl.json,a=o._add(o._add(o._add({},o.defaults),e),s,!0),l=a.adata;if("string"==typeof a.salt&&(a.salt=sjcl.codec.base64.toBits(a.salt)),"string"==typeof a.iv&&(a.iv=sjcl.codec.base64.toBits(a.iv)),!sjcl.mode[a.mode]||!sjcl.cipher[a.cipher]||"string"==typeof t&&a.iter<=100||64!==a.ts&&96!==a.ts&&128!==a.ts||128!==a.ks&&192!==a.ks&&256!==a.ks||!a.iv||a.iv.length<2||a.iv.length>4)throw new sjcl.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?(n=sjcl.misc.cachedPbkdf2(t,a),t=n.key.slice(0,a.ks/32),a.salt=n.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.secretKey&&(t=t.unkem(sjcl.codec.base64.toBits(a.kemtag)).slice(0,a.ks/32)),"string"==typeof l&&(l=sjcl.codec.utf8String.toBits(l)),c=new sjcl.cipher[a.cipher](t),r=sjcl.mode[a.mode].decrypt(c,a.ct,a.iv,l,a.ts),o._add(i,a),i.key=t,sjcl.codec.utf8String.fromBits(r)},decrypt:function(t,e,s,i){var r=sjcl.json;return r._decrypt(t,r.decode(e),s,i)},encode:function(t){var e,s="{",i="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");switch(s+=i+'"'+e+'":',i=",",typeof t[e]){case"number":case"boolean":s+=t[e];break;case"string":s+='"'+escape(t[e])+'"';break;case"object":s+='"'+sjcl.codec.base64.fromBits(t[e],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return s+"}"},decode:function(t){if(t=t.replace(/\s/g,""),!t.match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");var e,s,i=t.replace(/^\{|\}$/g,"").split(/,/),r={};for(e=0;e<i.length;e++){if(!(s=i[e].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");r[s[2]]=s[3]?parseInt(s[3],10):s[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(s[4]):unescape(s[4])}return r},_add:function(t,e,s){if(void 0===t&&(t={}),void 0===e)return t;var i;for(i in e)if(e.hasOwnProperty(i)){if(s&&void 0!==t[i]&&t[i]!==e[i])throw new sjcl.exception.invalid("required parameter overridden");t[i]=e[i]}return t},_subtract:function(t,e){var s,i={};for(s in t)t.hasOwnProperty(s)&&t[s]!==e[s]&&(i[s]=t[s]);return i},_filter:function(t,e){var s,i={};for(s=0;s<e.length;s++)void 0!==t[e[s]]&&(i[e[s]]=t[e[s]]);return i}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc._pbkdf2Cache={},sjcl.misc.cachedPbkdf2=function(t,e){var s,i,r,n,c=sjcl.misc._pbkdf2Cache;return e=e||{},n=e.iter||1e3,i=c[t]=c[t]||{},s=i[n]=i[n]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)},r=void 0===e.salt?s.firstSalt:e.salt,s[r]=s[r]||sjcl.misc.pbkdf2(t,r,e.iter),{key:s[r].slice(0),salt:r.slice(0)}},sjcl.codec.base58={_chars:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",fromBits:function(t){if(sjcl.bitArray.bitLength(t)>0){for(var e=sjcl.bn.fromBits(t),s=(sjcl.bn.fromBits(t),""),i=sjcl.codec.base58._chars;e.greaterEquals(1);){var r=this._divmod58(e),n=r.n.getLimb(0);e=r.q,s=i[n]+s}for(var c=sjcl.codec.hex.fromBits(t),o=c.match(/^0*/)[0].length,a=Math.floor(o/2),l=a;l>0;l--)s="1"+s;return s}return""},toBits:function(t){var e,s=this._powersOf58(t.length),i=new sjcl.bn,r=sjcl.codec.base58._chars,n=0;for(e=0;e<t.length;e++){var c=r.indexOf(t.charAt(e)),o=t.length-e-1;if(0>c)throw new sjcl.exception.invalid("this isn't base58!");var a=new sjcl.bn(c).mul(s[o]);i.addM(a)}if(t.length>0){var l=i.trim(),h=l.equals(0)?"":l.toString().substr(2),f=t.match(/^1*/)[0].length;return n=4*h.length+8*f,l.toBits(n)}return""},_divmod58:function(t){for(var e={q:new sjcl.bn(0),n:new sjcl.bn(t)},s=new sjcl.bn(58),i=new sjcl.bn(1),r=[i];e.n.greaterEquals(i);)r.push(i),i=i.mul(s);for(;e.n.greaterEquals(s);){var n=r.length-1,c=1;for(r.length>1&&(c=r[n-1]),i=r[n];i.greaterEquals(e.n.add(1));)n--,i=r[n],c=r[n-1];e.n.subM(i),e.q.addM(c),e.n.normalize()}return e},_powersOf58:function(t){for(var e=[new sjcl.bn(1)],s=1;t>=s;s++){var i=new sjcl.bn(58).mul(e[s-1]);e.push(i)}return e}},sjcl.ecc.ecdsa.secretKey.prototype.encodeDER=function(t){for(var e=sjcl.bitArray,s=this._curve.r,i=s.bitLength(),r=sjcl.codec.bytes.fromBits(e.bitSlice(t,0,i)),n=sjcl.codec.bytes.fromBits(e.bitSlice(t,i,2*i));!r[0]&&r.length;)r.shift();for(;!n[0]&&n.length;)n.shift();128&r[0]&&r.unshift(0),128&n[0]&&n.unshift(0);var c=[].concat(48,4+r.length+n.length,2,r.length,r,2,n.length,n);return sjcl.codec.bytes.toBits(c)},sjcl.ecc.ecdsa.secretKey.prototype.signDER=function(t,e){return this.encodeDER(this.sign(t,e))},function(){function t(t,e,s){return t^e^s}function e(t,e,s){return t&e|~t&s}function s(t,e,s){return(t|~e)^s}function i(t,e,s){return t&s|e&~s}function r(t,e,s){return t^(e|~s)}function n(t,e){return t<<e|t>>>32-e}function c(t){return(255&t)<<24|(65280&t)<<8|(t&255<<16)>>>8|(t&255<<24)>>>24}function o(c){for(var o,a=this._h[0],f=this._h[1],u=this._h[2],g=this._h[3],y=this._h[4],_=this._h[0],v=this._h[1],j=this._h[2],w=this._h[3],x=this._h[4],E=0;16>E;++E)o=n(a+t(f,u,g)+c[d[E]]+l[E],b[E])+y,a=y,y=g,g=n(u,10),u=f,f=o,o=n(_+r(v,j,w)+c[p[E]]+h[E],m[E])+x,_=x,x=w,w=n(j,10),j=v,v=o;for(;32>E;++E)o=n(a+e(f,u,g)+c[d[E]]+l[E],b[E])+y,a=y,y=g,g=n(u,10),u=f,f=o,o=n(_+i(v,j,w)+c[p[E]]+h[E],m[E])+x,_=x,x=w,w=n(j,10),j=v,v=o;for(;48>E;++E)o=n(a+s(f,u,g)+c[d[E]]+l[E],b[E])+y,a=y,y=g,g=n(u,10),u=f,f=o,o=n(_+s(v,j,w)+c[p[E]]+h[E],m[E])+x,_=x,x=w,w=n(j,10),j=v,v=o;for(;64>E;++E)o=n(a+i(f,u,g)+c[d[E]]+l[E],b[E])+y,a=y,y=g,g=n(u,10),u=f,f=o,o=n(_+e(v,j,w)+c[p[E]]+h[E],m[E])+x,_=x,x=w,w=n(j,10),j=v,v=o;for(;80>E;++E)o=n(a+r(f,u,g)+c[d[E]]+l[E],b[E])+y,a=y,y=g,g=n(u,10),u=f,f=o,o=n(_+t(v,j,w)+c[p[E]]+h[E],m[E])+x,_=x,x=w,w=n(j,10),j=v,v=o;o=this._h[1]+u+w,this._h[1]=this._h[2]+g+x,this._h[2]=this._h[3]+y+_,this._h[3]=this._h[4]+a+v,this._h[4]=this._h[0]+f+j,this._h[0]=o}sjcl.hash.ripemd160=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.ripemd160.hash=function(t){return(new sjcl.hash.ripemd160).update(t).finalize()},sjcl.hash.ripemd160.prototype={reset:function(){return this._h=a.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,s=this._buffer=sjcl.bitArray.concat(this._buffer,t),i=this._length,r=this._length=i+sjcl.bitArray.bitLength(t);for(e=512+i&-512;r>=e;e+=512){for(var n=s.splice(0,16),a=0;16>a;++a)n[a]=c(n[a]);o.call(this,n)}return this},finalize:function(){var t=sjcl.bitArray.concat(this._buffer,[sjcl.bitArray.partial(1,1)]),e=(this._length+1)%512,s=(e>448?512:448)-e%448,i=s%32;for(i>0&&(t=sjcl.bitArray.concat(t,[sjcl.bitArray.partial(i,0)]));s>=32;s-=32)t.push(0);for(t.push(c(0|this._length)),t.push(c(Math.floor(this._length/4294967296)));t.length;){for(var r=t.splice(0,16),n=0;16>n;++n)r[n]=c(r[n]);o.call(this,r)}var a=this._h;this.reset();for(var l=0;5>l;++l)a[l]=c(a[l]);return a}};for(var a=[1732584193,4023233417,2562383102,271733878,3285377520],l=[0,1518500249,1859775393,2400959708,2840853838],h=[1352829926,1548603684,1836072691,2053994217,0],f=4;f>=0;--f)for(var u=1;16>u;++u)l.splice(f,0,l[f]),h.splice(f,0,h[f]);var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]}();var Bitcoin=function(){};Bitcoin.paranoia=10,Bitcoin.Address=function(){},Bitcoin.Address.validate=function(t){var e=/^1[1-9A-HJ-NP-Za-km-z]{27,33}/.test(t);if(e){var s=sjcl.codec.base58.toBits(t),i=sjcl.bitArray.bitLength(s),r=sjcl.bitArray.clamp(s,i-32),n=sjcl.bitArray.bitSlice(s,i-32),c=sjcl.hash.sha256.hash(sjcl.hash.sha256.hash(r));return sjcl.bitArray.equal(sjcl.bitArray.clamp(c,32),n)}return!1},Bitcoin.Address.generate=function(t){var e=sjcl.ecc.curves.k256,s=sjcl.ecc.ecdsa.generateKeys(e,Bitcoin.paranoia),i=sjcl.bitArray.concat(sjcl.bitArray.concat(sjcl.codec.hex.toBits("0x04"),s.pub.get().x),s.pub.get().y),r=sjcl.bitArray.concat(sjcl.codec.hex.toBits("0x00"),sjcl.hash.ripemd160.hash(sjcl.hash.sha256.hash(i))),n=sjcl.bitArray.clamp(sjcl.hash.sha256.hash(sjcl.hash.sha256.hash(r)),32),c=sjcl.codec.base58.fromBits(sjcl.bitArray.concat(r,n));t({curve:e,privateKeyExponent:s.sec.get(),publicKeyX:s.pub.get().x,publicKeyY:s.pub.get().y,bitcoinAddress:c})},Bitcoin.parseCode=function(t){if(Bitcoin.Address.validate(t))return{address:t};var e=/^(?:bitcoin:)(?:\/\/)?(1[1-9A-HJ-NP-Za-km-z]{27,33})\??(.*)/.exec(t),s={};if(e&&3===e.length){for(var i=e[1],r=e[2],n=r.split("&"),c=0;c<n.length;c++){var o=n[c].split("=");if(o[0]&&o[1]){var a=decodeURIComponent(o[0]),l=decodeURIComponent(o[1]);s[a]=l}}s.amount&&(s.amount=parseFloat(s.amount)),s.address=i}return s},Bitcoin.Transaction=function(){this.outputs=[],this.inputs=[],this._bigToLittleEndian=function(t,e){t.length%2===1&&(t="0"+t),"undefined"==typeof e&&(e=t.length/2);for(var s="",i=0,r=e;r>0;r--){var n=t.substr(2*r-2,2);""===n?i++:s+=n}for(;i>0;)s+="00",i--;return s},this._btcTo8ByteLittleEndianHex=function(t){var e=parseInt((1e8*t).toFixed(0),10);return this._bigToLittleEndian(e.toString(16),8)},this._bitcoinAddressToPubKeyHash=function(t){var e=sjcl.codec.hex.fromBits(sjcl.codec.base58.toBits(t));return e.substring(2,e.length-8)},this._variableInt=function(t){var e="";return 253>t?e=this._bigToLittleEndian(t.toString(16),1):65535>=t?(e=this._bigToLittleEndian(t.toString(16),2),e="fd"+e):4294967295>=t?(e=this._bigToLittleEndian(t.toString(16),4),e="fe"+e):(e=this._bigToLittleEndian(t.toString(16),8),e="ff"+e),e},this._byteLength=function(t){return this._variableInt(t.length/2)}},Bitcoin.Transaction.prototype.addPayToPubKeyHashOutput=function(t,e){if(!Bitcoin.Address.validate(t))throw"Invalid Bitcoin address";if(1e-8>e)throw"Invalid amount. Must be more than 0.00000001 BTC";var s="",i=this._btcTo8ByteLittleEndianHex(e),r="76a9",n=this._bitcoinAddressToPubKeyHash(t);r+=this._byteLength(n),r+=n,r+="88ac";var c=this._byteLength(r);s+=i,s+=c,s+=r,this.outputs.push(s)},Bitcoin.Transaction.prototype.addInput=function(t){var e=this,s={hash:t.tx_hash,index:this._bigToLittleEndian(parseInt(t.tx_output_n,10).toString(16),4),script:t.script};s.rawHex=function(t){var s="";s+=this.hash,s+=this.index;var i;return i="undefined"==typeof t?this.script:t,s+=e._byteLength(i),s+=i,s+="ffffffff"},this.inputs.push(s)},Bitcoin.Transaction.prototype.rawHex=function(t){var e="";if(e+="01000000",e+=this._variableInt(this.inputs.length),"string"==typeof t)e+=t;else for(var s=0;s<this.inputs.length;s++)e+=this.inputs[s].rawHex();e+=this._variableInt(this.outputs.length);for(var i=0;i<this.outputs.length;i++)e+=this.outputs[i];return e+="00000000"},Bitcoin.Transaction.prototype.sign=function(t,e,s){for(var i=new sjcl.ecc.ecdsa.secretKey(sjcl.ecc.curves.k256,sjcl.bn.fromBits(sjcl.codec.hex.toBits(t))),r="04"+e+s,n="",c=0;c<this.inputs.length;c++){for(var o="",a=0;a<this.inputs.length;a++)o+=c===a?this.inputs[a].rawHex():this.inputs[a].rawHex("");var l=this.rawHex(o)+"01000000",h=sjcl.hash.sha256.hash(sjcl.hash.sha256.hash(sjcl.codec.hex.toBits(l))),f=sjcl.codec.hex.fromBits(i.signDER(h,10))+"01",u=this._byteLength(f)+f+"41"+r;n+=this.inputs[c].rawHex(u)}var d=this.rawHex(n);return d};var seedGenerateAndEncryptKeys=function(t,e,s){if(t.length<32)throw"Seed must be 32 words";if(e.length<4)throw"Password must be at least 4 characters";sjcl.random.addEntropy(t,1024,"client"),Bitcoin.Address.generate(function(t){var i={};i.encryptedPrivateKeyExponent=sjcl.json.encrypt(e,sjcl.codec.hex.fromBits(t.privateKeyExponent)),i.publicKeyX=sjcl.codec.hex.fromBits(t.publicKeyX),i.publicKeyY=sjcl.codec.hex.fromBits(t.publicKeyY),i.bitcoinAddress=t.bitcoinAddress,s(i)})},parseCode=function(t,e){var s=Bitcoin.parseCode(t);e(s)},validateAddress=function(t,e){var s=Bitcoin.Address.validate(t);e(s)},getPrivateKeyWIF=function(t,e,s){try{var i=sjcl.json.decrypt(t,e.encryptedPrivateKeyExponent),r="80"+i,n=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(sjcl.codec.hex.toBits(r))),c=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(sjcl.codec.hex.toBits(n))),o=c.substr(0,8),a=r+o,l=sjcl.codec.base58.fromBits(sjcl.codec.hex.toBits(a));s(l)}catch(h){s(h instanceof sjcl.exception.corrupt?{error:"Invalid Password"}:{error:"Error: "+h.message})}},buildAndSignRawTransaction=function(t,e,s,i,r,n){if(t.length<32)throw"Seed must be 32 words";sjcl.random.addEntropy(t,1024,"client");for(var c=new Bitcoin.Transaction,o=0;o<i.length;o++){var a=i[o];c.addInput(a)}for(var l=0;l<r.length;l++){var h=r[l];c.addPayToPubKeyHashOutput(h.address,h.amount)}try{var f=sjcl.json.decrypt(e,s.encryptedPrivateKeyExponent),u=c.sign(f,s.publicKeyX,s.publicKeyY);n(u)}catch(d){n(d instanceof sjcl.exception.corrupt?{error:"Invalid Password"}:{error:"Error: "+d.message})}},messageListener=function(t){if(t.data.functionName){var e=t.data.id,s=t.data.functionName,i=JSON.parse(t.data.params),r=self[s];i.push(function(t){var s={id:e,result:t};self.postMessage(s)}),"function"==typeof r&&r.apply(null,i)}};self.addEventListener("message",messageListener);